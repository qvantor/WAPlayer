{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///WAPlayer.min.js","webpack:///webpack/bootstrap e6afad0c0a8048799c38","webpack:///./src/index.js","webpack:///./src/visualization/index.js","webpack:///./src/visualization/default.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","_visualization","Player","ctx","AudioContext","gain","createGain","analyser","createAnalyser","paused","time","events","play","pause","timeChange","seek","load","endFile","value","_this","loading","_createSource","source","start","_interval","setInterval","_last","Date","duration","stop","_emit","clearInterval","vol","src","_this2","Promise","resolve","reject","_loadSoundFile","then","data","buffer","toFixed","event","cb","push","_this3","forEach","fn","createBufferSource","connect","destination","url","context","_this4","xhr","XMLHttpRequest","open","responseType","onprogress","e","onload","decodeAudioData","response","decodedArrayBuffer","onerror","send","Visualization","undefined","_default2","default","config","fftSize","specification","parent","document","querySelector","selector","canvas","createElement","width","clientWidth","height","appendChild","canvasCtx","getContext","dataArray","Uint8Array","frequencyBinCount","grd","createLinearGradient","gardient","item","addColorStop","hzPerNumber","sampleRate","startHz","Math","round","endHz","animation","getByteFrequencyData","clearRect","beginPath","moveTo","lineTo","fillStyle","fill","lineWidth","stroke","requestAnimationFrame","bind"],"mappings":"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","file":"WAPlayer.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WAPlayer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WAPlayer\"] = factory();\n\telse\n\t\troot[\"WAPlayer\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WAPlayer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WAPlayer\"] = factory();\n\telse\n\t\troot[\"WAPlayer\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _visualization = __webpack_require__(1);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Player = function () {\n\t    function Player() {\n\t        _classCallCheck(this, Player);\n\t\n\t        this.ctx = new AudioContext();\n\t        this.gain = this.ctx.createGain();\n\t        this.analyser = this.ctx.createAnalyser();\n\t        this.paused = true;\n\t        this.time = 0;\n\t\n\t        this.events = {\n\t            play: [],\n\t            pause: [],\n\t            timeChange: [],\n\t            seek: [],\n\t            load: [],\n\t            loaded: [],\n\t            endFile: []\n\t        };\n\t    }\n\t\n\t    _createClass(Player, [{\n\t        key: 'play',\n\t        value: function play() {\n\t            var _this = this;\n\t\n\t            if (!this.paused || this.loading) return;\n\t\n\t            this._createSource();\n\t\n\t            this.paused = false;\n\t\n\t            if (this.time > 0) {\n\t                this.source.start(0, this.time);\n\t            } else {\n\t                this.source.start(0);\n\t            }\n\t\n\t            this._interval = setInterval(function () {\n\t                if (_this._last) {\n\t                    _this.time = _this.time + (new Date() - _this._last) / 1000;\n\t                }\n\t                _this._last = new Date();\n\t                if (_this.time >= _this.duration) {\n\t                    _this.stop();\n\t                    _this._emit('endFile');\n\t                }\n\t                _this._emit('timeChange', _this.time);\n\t            }, 50);\n\t\n\t            this._emit('play');\n\t        }\n\t    }, {\n\t        key: 'pause',\n\t        value: function pause() {\n\t            if (this.loading || this.paused) return;\n\t\n\t            this.paused = true;\n\t\n\t            this.source.stop(0);\n\t            this._last = null;\n\t            clearInterval(this._interval);\n\t            this._emit('pause');\n\t        }\n\t    }, {\n\t        key: 'stop',\n\t        value: function stop() {\n\t            if (this.loading || this.paused) return;\n\t            this.paused = true;\n\t            this.time = 0;\n\t            this._last = null;\n\t            clearInterval(this._interval);\n\t            this.source.stop(0);\n\t            this._emit('pause');\n\t        }\n\t    }, {\n\t        key: 'toggle',\n\t        value: function toggle() {\n\t            this.paused ? this.play() : this.pause();\n\t        }\n\t    }, {\n\t        key: 'volume',\n\t        value: function volume(vol) {\n\t            this.gain.gain.value = vol;\n\t        }\n\t    }, {\n\t        key: 'seek',\n\t        value: function seek(time) {\n\t            if (this.loading) return;\n\t            if (time < 0) return;\n\t\n\t            this.time = time;\n\t\n\t            if (!this.paused) {\n\t                this.source.stop(0);\n\t                this._createSource();\n\t                this.source.start(0, this.time);\n\t            }\n\t            this._emit('timeChange', time);\n\t            this._emit('seek', time);\n\t        }\n\t    }, {\n\t        key: 'load',\n\t        value: function load(src) {\n\t            var _this2 = this;\n\t\n\t            // @todo find way to cancel last one and make new one\n\t            return new Promise(function (resolve, reject) {\n\t                if (_this2.loading) return reject(false);\n\t                if (_this2.source) {\n\t                    clearInterval(_this2._interval);\n\t                    _this2.source.stop(0);\n\t                }\n\t                _this2.loading = true;\n\t\n\t                _this2._loadSoundFile(src, _this2.ctx).then(function (data) {\n\t                    _this2.buffer = data;\n\t                    _this2.duration = data.duration.toFixed(0);\n\t                    _this2.time = 0;\n\t                    _this2.paused = true;\n\t                    _this2.loading = false;\n\t                    _this2._createSource();\n\t                    _this2._emit('loaded');\n\t                    resolve(_this2);\n\t                }).catch(reject);\n\t            });\n\t        }\n\t    }, {\n\t        key: 'on',\n\t        value: function on(event, cb) {\n\t            if (this.events[event] && typeof cb === 'function') {\n\t                this.events[event].push(cb);\n\t            }\n\t            return this;\n\t        }\n\t    }, {\n\t        key: '_emit',\n\t        value: function _emit(event, data) {\n\t            var _this3 = this;\n\t\n\t            if (this.events[event].length > 0) {\n\t                this.events[event].forEach(function (fn) {\n\t                    fn.call(_this3, data);\n\t                });\n\t            }\n\t        }\n\t    }, {\n\t        key: '_createSource',\n\t        value: function _createSource() {\n\t            this.source = this.ctx.createBufferSource();\n\t            this.source.connect(this.gain);\n\t\n\t            this.source.connect(this.analyser);\n\t            this.gain.connect(this.ctx.destination);\n\t\n\t            this.source.buffer = this.buffer;\n\t        }\n\t    }, {\n\t        key: '_loadSoundFile',\n\t        value: function _loadSoundFile(url, context) {\n\t            var _this4 = this;\n\t\n\t            return new Promise(function (resolve, reject) {\n\t                var xhr = new XMLHttpRequest();\n\t\n\t                xhr.open('GET', url, true);\n\t                xhr.responseType = 'arraybuffer';\n\t                xhr.onprogress = function (e) {\n\t                    _this4._emit('load', e);\n\t                };\n\t                xhr.onload = function (e) {\n\t                    context.decodeAudioData(this.response, function (decodedArrayBuffer) {\n\t                        resolve(decodedArrayBuffer);\n\t                    }, function (e) {\n\t                        reject('Error decoding file', e);\n\t                    });\n\t                };\n\t                xhr.onerror = function (e) {\n\t                    reject(e);\n\t                };\n\t                xhr.send();\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Player;\n\t}();\n\t\n\texports.Player = Player;\n\texports.Visualization = _visualization.Visualization;\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.Visualization = undefined;\n\t\n\tvar _default2 = __webpack_require__(2);\n\t\n\tvar Visualization = exports.Visualization = {\n\t    default: _default2.Visualization\n\t};\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Visualization = exports.Visualization = function () {\n\t    function Visualization(analyser, config) {\n\t        var _this = this;\n\t\n\t        _classCallCheck(this, Visualization);\n\t\n\t        this.analyser = analyser;\n\t        this.analyser.fftSize = config.specification || 2048;\n\t        this.parent = document.querySelector(config.selector);\n\t        this.canvas = document.createElement('canvas');\n\t        this.canvas.width = this.parent.clientWidth;\n\t        this.canvas.height = 255;\n\t        this.parent.appendChild(this.canvas);\n\t        this.canvasCtx = this.canvas.getContext('2d');\n\t        this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n\t\n\t        this.grd = this.canvasCtx.createLinearGradient(0, 255, 0, 0);\n\t        config.gardient.forEach(function (item) {\n\t            _this.grd.addColorStop(item[0], item[1]);\n\t        });\n\t\n\t        this.hzPerNumber = this.analyser.context.sampleRate / this.analyser.fftSize;\n\t        this.startHz = Math.round(50 / this.hzPerNumber);\n\t        this.endHz = Math.round(20000 / this.hzPerNumber);\n\t        this.animation();\n\t    }\n\t\n\t    _createClass(Visualization, [{\n\t        key: 'animation',\n\t        value: function animation() {\n\t            this.canvas.width = this.parent.clientWidth;\n\t\n\t            var width = this.canvas.clientWidth / this.dataArray.length * 1.4;\n\t\n\t            this.analyser.getByteFrequencyData(this.dataArray);\n\t            this.canvasCtx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t            this.canvasCtx.beginPath();\n\t            this.canvasCtx.moveTo(0, 255);\n\t\n\t            for (var i = this.startHz; i < this.endHz; i++) {\n\t                this.canvasCtx.lineTo(i * width, 255 - this.dataArray[i]);\n\t            }\n\t\n\t            this.canvasCtx.lineTo(this.dataArray.length * width, 255);\n\t\n\t            this.canvasCtx.fillStyle = this.grd;\n\t            this.canvasCtx.fill();\n\t            this.canvasCtx.lineWidth = 0.001;\n\t            this.canvasCtx.stroke();\n\t\n\t            requestAnimationFrame(this.animation.bind(this));\n\t        }\n\t    }]);\n\n\t    return Visualization;\n\t}();\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** WAPlayer.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e6afad0c0a8048799c38\n **/","import {Visualization} from './visualization/';\n\nclass Player {\n    constructor() {\n        this.ctx = new AudioContext();\n        this.gain = this.ctx.createGain();\n        this.analyser = this.ctx.createAnalyser();\n        this.paused = true;\n        this.time = 0;\n\n        this.events = {\n            play: [],\n            pause: [],\n            timeChange: [],\n            seek: [],\n            load: [],\n            loaded: [],\n            endFile: []\n        };\n    }\n\n    play() {\n        if (!this.paused || this.loading) return;\n\n        this._createSource();\n\n        this.paused = false;\n\n        if (this.time > 0) {\n            this.source.start(0, this.time);\n        } else {\n            this.source.start(0);\n        }\n\n        this._interval = setInterval(() => {\n            if (this._last) {\n                this.time = this.time + ((new Date() - this._last) / 1000);\n            }\n            this._last = new Date();\n            if (this.time >= this.duration) {\n                this.stop();\n                this._emit('endFile');\n            }\n            this._emit('timeChange', this.time);\n        }, 50);\n\n        this._emit('play');\n    }\n\n    pause() {\n        if (this.loading || this.paused) return;\n\n        this.paused = true;\n\n        this.source.stop(0);\n        this._last = null;\n        clearInterval(this._interval);\n        this._emit('pause');\n    }\n\n    stop() {\n        if (this.loading || this.paused) return;\n        this.paused = true;\n        this.time = 0;\n        this._last = null;\n        clearInterval(this._interval);\n        this.source.stop(0);\n        this._emit('pause');\n    }\n\n    toggle() {\n        this.paused ? this.play() : this.pause();\n    }\n\n    volume(vol) {\n        this.gain.gain.value = vol;\n    }\n\n    seek(time) {\n        if (this.loading) return;\n        if (time < 0) return;\n\n        this.time = time;\n\n        if (!this.paused) {\n            this.source.stop(0);\n            this._createSource();\n            this.source.start(0, this.time);\n        }\n        this._emit('timeChange', time);\n        this._emit('seek', time);\n    }\n\n    load(src) {\n        // @todo find way to cancel last one and make new one\n        return new Promise((resolve, reject) => {\n            if (this.loading) return reject(false);\n            if (this.source) {\n                clearInterval(this._interval);\n                this.source.stop(0);\n            }\n            this.loading = true;\n\n            this._loadSoundFile(src, this.ctx).then((data) => {\n                this.buffer = data;\n                this.duration = data.duration.toFixed(0);\n                this.time = 0;\n                this.paused = true;\n                this.loading = false;\n                this._createSource();\n                this._emit('loaded');\n                resolve(this);\n            }).catch(reject);\n        });\n    }\n\n    on(event, cb) {\n        if (this.events[event] && typeof cb === 'function') {\n            this.events[event].push(cb);\n        }\n        return this;\n    }\n\n    _emit(event, data) {\n        if (this.events[event].length > 0) {\n            this.events[event].forEach((fn) => {\n                fn.call(this, data);\n            });\n        }\n    }\n\n    _createSource() {\n        this.source = this.ctx.createBufferSource();\n        this.source.connect(this.gain);\n\n        this.source.connect(this.analyser);\n        this.gain.connect(this.ctx.destination);\n\n        this.source.buffer = this.buffer;\n    }\n\n    _loadSoundFile(url, context) {\n        return new Promise((resolve, reject) => {\n            let xhr = new XMLHttpRequest();\n\n            xhr.open('GET', url, true);\n            xhr.responseType = 'arraybuffer';\n            xhr.onprogress = (e) => {\n                this._emit('load', e);\n            };\n            xhr.onload = function (e) {\n                context.decodeAudioData(this.response,\n                    function (decodedArrayBuffer) {\n                        resolve(decodedArrayBuffer);\n                    }, function (e) {\n                        reject('Error decoding file', e);\n                    });\n            };\n            xhr.onerror = function (e) {\n                reject(e);\n            };\n            xhr.send();\n        });\n    }\n}\n\nexports.Player = Player;\nexports.Visualization = Visualization;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/index.js\n **/","import {Visualization as _default} from './default';\n\nexport let Visualization = {\n    default: _default\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/visualization/index.js\n **/","export class Visualization {\n    constructor(analyser, config) {\n        this.analyser = analyser;\n        this.analyser.fftSize = config.specification || 2048;\n        this.parent = document.querySelector(config.selector);\n        this.canvas = document.createElement('canvas');\n        this.canvas.width = this.parent.clientWidth;\n        this.canvas.height = 255;\n        this.parent.appendChild(this.canvas);\n        this.canvasCtx = this.canvas.getContext('2d');\n        this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n\n        this.grd = this.canvasCtx.createLinearGradient(0, 255, 0, 0);\n        config.gardient.forEach((item) => {\n            this.grd.addColorStop(item[0], item[1]);\n        });\n\n        this.hzPerNumber = this.analyser.context.sampleRate / this.analyser.fftSize;\n        this.startHz = Math.round(50 / this.hzPerNumber);\n        this.endHz = Math.round(20000 / this.hzPerNumber);\n        this.animation();\n    }\n\n    animation() {\n        this.canvas.width = this.parent.clientWidth;\n\n        let width = (this.canvas.clientWidth / this.dataArray.length) * 1.4;\n\n        this.analyser.getByteFrequencyData(this.dataArray);\n        this.canvasCtx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        this.canvasCtx.beginPath();\n        this.canvasCtx.moveTo(0, 255);\n\n        for (let i = this.startHz; i < this.endHz; i++) {\n            this.canvasCtx.lineTo(i * width, 255 - this.dataArray[i]);\n        }\n\n        this.canvasCtx.lineTo(this.dataArray.length * width, 255);\n\n        this.canvasCtx.fillStyle = this.grd;\n        this.canvasCtx.fill();\n        this.canvasCtx.lineWidth = 0.001;\n        this.canvasCtx.stroke();\n\n        requestAnimationFrame(this.animation.bind(this));\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/visualization/default.js\n **/"],"sourceRoot":""}